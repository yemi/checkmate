// Generated by psc version 0.8.5.0
"use strict";
var Prelude = require("../Prelude");
var Control_Comonad = require("../Control.Comonad");
var Control_Alt = require("../Control.Alt");
var Control_MonadPlus = require("../Control.MonadPlus");
var Control_Extend = require("../Control.Extend");
var Control_Monad_Trampoline = require("../Control.Monad.Trampoline");
var Data_Foldable = require("../Data.Foldable");
var Data_Traversable = require("../Data.Traversable");
var Control_Monad_Free = require("../Control.Monad.Free");
var Cofree = (function () {
    function Cofree(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Cofree.create = function (value0) {
        return function (value1) {
            return new Cofree(value0, value1);
        };
    };
    return Cofree;
})();
var tail = function (v) {
    return Control_Monad_Trampoline.runTrampoline(v.value1);
};
var mkCofree = function (a) {
    return function (t) {
        return new Cofree(a, Prelude.pure(Control_Monad_Free.freeApplicative)(t));
    };
};
var head = function (v) {
    return v.value0;
};
var foldableCofree = function (dictFoldable) {
    return new Data_Foldable.Foldable(function (dictMonoid) {
        return function (f) {
            var go = function (fa) {
                return Prelude["++"](dictMonoid["__superclass_Prelude.Semigroup_0"]())(f(head(fa)))(Data_Foldable.foldMap(dictFoldable)(dictMonoid)(go)(tail(fa)));
            };
            return go;
        };
    }, function (f) {
        var go = function (b) {
            return function (fa) {
                var fa$prime = tail(fa);
                var b$prime = f(b)(head(fa));
                return Data_Foldable.foldl(dictFoldable)(go)(b$prime)(fa$prime);
            };
        };
        return go;
    }, function (f) {
        var go = function (fa) {
            return function (b) {
                var b$prime = Data_Foldable.foldr(dictFoldable)(go)(b)(tail(fa));
                var a$prime = head(fa);
                return f(a$prime)(b$prime);
            };
        };
        return Prelude.flip(go);
    });
};
var _tail = function (v) {
    return v.value1;
};
var _lift = function (dictFunctor) {
    return function (f) {
        return Prelude["<$>"](Control_Monad_Free.freeFunctor)(Prelude["<$>"](dictFunctor)(f));
    };
};
var functorCofree = function (dictFunctor) {
    return new Prelude.Functor(function (f) {
        var loop = function (fa) {
            return new Cofree(f(head(fa)), _lift(dictFunctor)(loop)(_tail(fa)));
        };
        return loop;
    });
};
var applyCofree = function (dictApply) {
    return new Prelude.Apply(function () {
        return functorCofree(dictApply["__superclass_Prelude.Functor_0"]());
    }, function (f) {
        return function (x) {
            var t = Prelude["<*>"](dictApply)(Prelude["<$>"](dictApply["__superclass_Prelude.Functor_0"]())(Prelude["<*>"](applyCofree(dictApply)))(tail(f)))(tail(x));
            var h = head(f)(head(x));
            return mkCofree(h)(t);
        };
    });
};
var applicativeCofree = function (dictApplicative) {
    return new Prelude.Applicative(function () {
        return applyCofree(dictApplicative["__superclass_Prelude.Apply_0"]());
    }, function (a) {
        return mkCofree(a)(Prelude.pure(dictApplicative)(Prelude.pure(applicativeCofree(dictApplicative))(a)));
    });
};
var bindCofree = function (dictMonadPlus) {
    return new Prelude.Bind(function () {
        return applyCofree(((dictMonadPlus["__superclass_Control.Alternative.Alternative_1"]())["__superclass_Prelude.Applicative_0"]())["__superclass_Prelude.Apply_0"]());
    }, function (fa) {
        return function (f) {
            var loop = function (fa1) {
                var fh = f(head(fa1));
                return mkCofree(head(fh))(Control_Alt["<|>"](((dictMonadPlus["__superclass_Control.Alternative.Alternative_1"]())["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())(tail(fh))(Prelude["<$>"]((((dictMonadPlus["__superclass_Control.Alternative.Alternative_1"]())["__superclass_Control.Plus.Plus_1"]())["__superclass_Control.Alt.Alt_0"]())["__superclass_Prelude.Functor_0"]())(loop)(tail(fa1))));
            };
            return loop(fa);
        };
    });
};
var monadCofree = function (dictMonadPlus) {
    return new Prelude.Monad(function () {
        return applicativeCofree((dictMonadPlus["__superclass_Control.Alternative.Alternative_1"]())["__superclass_Prelude.Applicative_0"]());
    }, function () {
        return bindCofree(dictMonadPlus);
    });
};
var extendCofree = function (dictFunctor) {
    return new Control_Extend.Extend(function () {
        return functorCofree(dictFunctor);
    }, function (f) {
        var loop = function (fa) {
            return new Cofree(f(fa), _lift(dictFunctor)(loop)(_tail(fa)));
        };
        return loop;
    });
};
var comonadCofree = function (dictFunctor) {
    return new Control_Comonad.Comonad(function () {
        return extendCofree(dictFunctor);
    }, head);
};
var traversableCofree = function (dictTraversable) {
    return new Data_Traversable.Traversable(function () {
        return foldableCofree(dictTraversable["__superclass_Data.Foldable.Foldable_1"]());
    }, function () {
        return functorCofree(dictTraversable["__superclass_Prelude.Functor_0"]());
    }, function (dictApplicative) {
        return Data_Traversable.traverse(traversableCofree(dictTraversable))(dictApplicative)(Prelude.id(Prelude.categoryFn));
    }, function (dictApplicative) {
        return function (f) {
            var loop = function (ta) {
                return Prelude["<*>"](dictApplicative["__superclass_Prelude.Apply_0"]())(Prelude["<$>"]((dictApplicative["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(mkCofree)(f(head(ta))))(Data_Traversable.traverse(dictTraversable)(dictApplicative)(loop)(tail(ta)));
            };
            return loop;
        };
    });
};
module.exports = {
    tail: tail, 
    head: head, 
    mkCofree: mkCofree, 
    functorCofree: functorCofree, 
    foldableCofree: foldableCofree, 
    traversableCofree: traversableCofree, 
    extendCofree: extendCofree, 
    comonadCofree: comonadCofree, 
    applyCofree: applyCofree, 
    applicativeCofree: applicativeCofree, 
    bindCofree: bindCofree, 
    monadCofree: monadCofree
};
