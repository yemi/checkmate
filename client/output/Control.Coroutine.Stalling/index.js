// Generated by psc version 0.8.5.0
"use strict";
var Prelude = require("../Prelude");
var Control_Coroutine = require("../Control.Coroutine");
var Control_Monad_Free_Trans = require("../Control.Monad.Free.Trans");
var Control_Monad_Maybe_Trans = require("../Control.Monad.Maybe.Trans");
var Control_Monad_Rec_Class = require("../Control.Monad.Rec.Class");
var Control_Monad_Trans = require("../Control.Monad.Trans");
var Control_Bind = require("../Control.Bind");
var Control_Plus = require("../Control.Plus");
var Data_Functor = require("../Data.Functor");
var Data_Bifunctor = require("../Data.Bifunctor");
var Data_Either = require("../Data.Either");
var Data_Identity = require("../Data.Identity");
var Data_Maybe = require("../Data.Maybe");
var Emit = (function () {
    function Emit(value0, value1) {
        this.value0 = value0;
        this.value1 = value1;
    };
    Emit.create = function (value0) {
        return function (value1) {
            return new Emit(value0, value1);
        };
    };
    return Emit;
})();
var Stall = (function () {
    function Stall(value0) {
        this.value0 = value0;
    };
    Stall.create = function (value0) {
        return new Stall(value0);
    };
    return Stall;
})();
var stallF = function (e) {
    return function (s) {
        return function (q) {
            if (q instanceof Emit) {
                return e(q.value0)(q.value1);
            };
            if (q instanceof Stall) {
                return s(q.value0);
            };
            throw new Error("Failed pattern match at Control.Coroutine.Stalling line 46, column 3 - line 50, column 1: " + [ q.constructor.name ]);
        };
    };
};
var runStallingProcess = function (dictMonadRec) {
    return function ($28) {
        return Control_Monad_Maybe_Trans.runMaybeT(Control_Monad_Free_Trans.runFreeT(Data_Maybe.functorMaybe)(Control_Monad_Maybe_Trans.monadRecMaybeT(dictMonadRec))(Data_Maybe.maybe(Control_Plus.empty(Control_Monad_Maybe_Trans.plusMaybeT(dictMonadRec["__superclass_Prelude.Monad_0"]())))(Prelude.pure(Control_Monad_Maybe_Trans.applicativeMaybeT(dictMonadRec["__superclass_Prelude.Monad_0"]()))))(Control_Monad_Free_Trans.hoistFreeT(Data_Maybe.functorMaybe)(Control_Monad_Maybe_Trans.functorMaybeT(dictMonadRec["__superclass_Prelude.Monad_0"]()))(function ($29) {
            return Control_Monad_Maybe_Trans.MaybeT(Prelude.map((((dictMonadRec["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(Data_Maybe.Just.create)($29));
        })($28)));
    };
};
var producerToStallingProducer = function (dictFunctor) {
    return Control_Monad_Free_Trans.interpret(Control_Coroutine.functorEmit)(dictFunctor)(function (v) {
        return new Emit(v.value0, v.value1);
    });
};
var processToStallingProcess = function (dictFunctor) {
    return Control_Monad_Free_Trans.interpret(Data_Identity.functorIdentity)(dictFunctor)(function ($30) {
        return Data_Maybe.Just.create(Data_Identity.runIdentity($30));
    });
};
var bifunctorStallF = new Data_Bifunctor.Bifunctor(function (f) {
    return function (g) {
        return function (q) {
            if (q instanceof Emit) {
                return new Emit(f(q.value0), g(q.value1));
            };
            if (q instanceof Stall) {
                return new Stall(g(q.value0));
            };
            throw new Error("Failed pattern match at Control.Coroutine.Stalling line 52, column 5 - line 56, column 1: " + [ q.constructor.name ]);
        };
    };
});
var functorStallF = new Prelude.Functor(function (f) {
    return Data_Bifunctor.rmap(bifunctorStallF)(f);
});
var emit = function (dictMonad) {
    return function ($31) {
        return Control_Monad_Free_Trans.liftFreeT(functorStallF)(dictMonad)(Prelude.flip(Emit.create)(Prelude.unit)($31));
    };
};
var catMaybes = function (dictMonadRec) {
    return Control_Monad_Rec_Class.tailRecM(Control_Monad_Free_Trans.monadRecFreeT(functorStallF)(dictMonadRec["__superclass_Prelude.Monad_0"]()))(Control_Bind[">=>"](Control_Monad_Free_Trans.bindFreeT(functorStallF)(dictMonadRec["__superclass_Prelude.Monad_0"]()))(function ($32) {
        return Control_Monad_Trans.lift(Control_Monad_Free_Trans.monadTransFreeT(functorStallF))(dictMonadRec["__superclass_Prelude.Monad_0"]())(Control_Monad_Free_Trans.resume(functorStallF)(dictMonadRec)($32));
    })(Data_Either.either(function ($33) {
        return Prelude.pure(Control_Monad_Free_Trans.applicativeFreeT(functorStallF)(dictMonadRec["__superclass_Prelude.Monad_0"]()))(Data_Either.Right.create($33));
    })(stallF(function (mo) {
        return function (t) {
            return Data_Functor["$>"](Control_Monad_Free_Trans.functorFreeT(functorStallF)((((dictMonadRec["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]()))(Data_Maybe.maybe(Prelude.pure(Control_Monad_Free_Trans.applicativeFreeT(functorStallF)(dictMonadRec["__superclass_Prelude.Monad_0"]()))(Prelude.unit))(emit(dictMonadRec["__superclass_Prelude.Monad_0"]()))(mo))(new Data_Either.Left(t));
        };
    })(function ($34) {
        return Prelude.pure(Control_Monad_Free_Trans.applicativeFreeT(functorStallF)(dictMonadRec["__superclass_Prelude.Monad_0"]()))(Data_Either.Left.create($34));
    }))));
};
var stall = function (dictMonad) {
    return Control_Monad_Free_Trans.liftFreeT(functorStallF)(dictMonad)(new Stall(Prelude.unit));
};
var $dollar$dollar$qmark = function (dictMonadRec) {
    return Control_Coroutine.fuseWith(functorStallF)(Control_Coroutine.functorAwait)(Data_Maybe.functorMaybe)(dictMonadRec)(function (f) {
        return function (q) {
            return function (v) {
                if (q instanceof Emit) {
                    return new Data_Maybe.Just(f(q.value1)(v(q.value0)));
                };
                if (q instanceof Stall) {
                    return Data_Maybe.Nothing.value;
                };
                throw new Error("Failed pattern match at Control.Coroutine.Stalling line 87, column 5 - line 91, column 1: " + [ q.constructor.name ]);
            };
        };
    });
};
var mapStallingProducer = function (dictFunctor) {
    return function ($35) {
        return Control_Monad_Free_Trans.interpret(functorStallF)(dictFunctor)(Data_Bifunctor.lmap(bifunctorStallF)($35));
    };
};
var filter = function (dictMonadRec) {
    return function (p) {
        return function ($36) {
            return catMaybes(dictMonadRec)(mapStallingProducer((((dictMonadRec["__superclass_Prelude.Monad_0"]())["__superclass_Prelude.Bind_1"]())["__superclass_Prelude.Apply_0"]())["__superclass_Prelude.Functor_0"]())(function (x) {
                var $27 = p(x);
                if ($27) {
                    return new Data_Maybe.Just(x);
                };
                if (!$27) {
                    return Data_Maybe.Nothing.value;
                };
                throw new Error("Failed pattern match at Control.Coroutine.Stalling line 150, column 5 - line 150, column 33: " + [ $27.constructor.name ]);
            })($36));
        };
    };
};
module.exports = {
    Emit: Emit, 
    Stall: Stall, 
    filter: filter, 
    catMaybes: catMaybes, 
    mapStallingProducer: mapStallingProducer, 
    "$$?": $dollar$dollar$qmark, 
    runStallingProcess: runStallingProcess, 
    processToStallingProcess: processToStallingProcess, 
    producerToStallingProducer: producerToStallingProducer, 
    stallF: stallF, 
    stall: stall, 
    emit: emit, 
    bifunctorStallF: bifunctorStallF, 
    functorStallF: functorStallF
};
