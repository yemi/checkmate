// Generated by psc version 0.9.1
"use strict";
var Prelude = require("../Prelude");
var Control_Monad_Aff = require("../Control.Monad.Aff");
var Control_Monad_Eff = require("../Control.Monad.Eff");
var Control_Monad_Eff_Exception = require("../Control.Monad.Eff.Exception");
var Data_Exists = require("../Data.Exists");
var Data_ExistsR = require("../Data.ExistsR");
var Data_Foldable = require("../Data.Foldable");
var Data_Function_Uncurried = require("../Data.Function.Uncurried");
var Data_Lazy = require("../Data.Lazy");
var Data_Maybe = require("../Data.Maybe");
var Data_Monoid = require("../Data.Monoid");
var Data_Nullable = require("../Data.Nullable");
var Halogen_Effects = require("../Halogen.Effects");
var Halogen_Component_Tree = require("../Halogen.Component.Tree");
var Halogen_HTML_Core = require("../Halogen.HTML.Core");
var Halogen_HTML_Events_Handler = require("../Halogen.HTML.Events.Handler");
var Halogen_Internal_VirtualDOM = require("../Halogen.Internal.VirtualDOM");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Functor = require("../Data.Functor");
var Data_Function = require("../Data.Function");
var Control_Applicative = require("../Control.Applicative");
var Data_Unit = require("../Data.Unit");
var Data_Semigroup = require("../Data.Semigroup");
var Control_Bind = require("../Control.Bind");
var handleAff = function ($40) {
    return Data_Functor["void"](Control_Monad_Eff.functorEff)(Control_Monad_Aff.runAff(Control_Monad_Eff_Exception.throwException)(Data_Function["const"](Control_Applicative.pure(Control_Monad_Eff.applicativeEff)(Data_Unit.unit)))($40));
};
var renderProp = function (v) {
    return function (v1) {
        if (v1 instanceof Halogen_HTML_Core.Prop) {
            return Data_Exists.runExists(function (v2) {
                return Data_Function_Uncurried.runFn2(Halogen_Internal_VirtualDOM.prop)(Halogen_HTML_Core.runPropName(v2.value0))(v2.value1);
            })(v1.value0);
        };
        if (v1 instanceof Halogen_HTML_Core.Attr) {
            var attrName = Data_Maybe.maybe("")(function (ns$prime) {
                return Halogen_HTML_Core.runNamespace(ns$prime) + ":";
            })(v1.value0) + Halogen_HTML_Core.runAttrName(v1.value1);
            return Data_Function_Uncurried.runFn2(Halogen_Internal_VirtualDOM.attr)(attrName)(v1.value2);
        };
        if (v1 instanceof Halogen_HTML_Core.Handler) {
            return Data_ExistsR.runExistsR(function (v2) {
                return Data_Function_Uncurried.runFn2(Halogen_Internal_VirtualDOM.handlerProp)(Halogen_HTML_Core.runEventName(v2.value0))(function (ev) {
                    return Data_Function.apply(handleAff)(Control_Bind.bind(Control_Monad_Aff.bindAff)(Halogen_HTML_Events_Handler.runEventHandler(Control_Monad_Aff.monadAff)(Control_Monad_Aff.monadEffAff)(ev)(v2.value1(ev)))(Data_Maybe.maybe(Control_Applicative.pure(Control_Monad_Aff.applicativeAff)(Data_Unit.unit))(v)));
                });
            })(v1.value0);
        };
        if (v1 instanceof Halogen_HTML_Core.Ref) {
            return Halogen_Internal_VirtualDOM.refProp(function ($41) {
                return handleAff(v(v1.value0($41)));
            });
        };
        return Data_Monoid.mempty(Halogen_Internal_VirtualDOM.monoidProps);
    };
};
var findKey = function (v) {
    return function (v1) {
        if (v1 instanceof Halogen_HTML_Core.Key) {
            return new Data_Maybe.Just(v1.value0);
        };
        return v;
    };
};
var renderHTML = function (f) {
    var go = function (v) {
        if (v instanceof Halogen_HTML_Core.Text) {
            return Halogen_Internal_VirtualDOM.vtext(v.value0);
        };
        if (v instanceof Halogen_HTML_Core.Element) {
            var tag = Halogen_HTML_Core.runTagName(v.value1);
            var ns$prime = Data_Function.apply(Data_Nullable.toNullable)(Data_Functor.map(Data_Maybe.functorMaybe)(Halogen_HTML_Core.runNamespace)(v.value0));
            var key = Data_Function.apply(Data_Nullable.toNullable)(Data_Foldable.foldl(Data_Foldable.foldableArray)(findKey)(Data_Maybe.Nothing.value)(v.value2));
            return Halogen_Internal_VirtualDOM.vnode(ns$prime)(tag)(key)(Data_Foldable.foldMap(Data_Foldable.foldableArray)(Halogen_Internal_VirtualDOM.monoidProps)(renderProp(f))(v.value2))(Data_Functor.map(Data_Functor.functorArray)(go)(v.value3));
        };
        if (v instanceof Halogen_HTML_Core.Slot) {
            return Halogen_Internal_VirtualDOM.vtext("");
        };
        throw new Error("Failed pattern match at Halogen.HTML.Renderer.VirtualDOM line 34, column 3 - line 34, column 26: " + [ v.constructor.name ]);
    };
    return go;
};
var renderTree = function (f) {
    return Halogen_Component_Tree.runTree(function (tree) {
        var go = function (v) {
            if (v instanceof Halogen_HTML_Core.Text) {
                return Halogen_Internal_VirtualDOM.vtext(v.value0);
            };
            if (v instanceof Halogen_HTML_Core.Slot) {
                return Halogen_Internal_VirtualDOM.widget(v.value0)(tree.eq)(renderTree(f));
            };
            if (v instanceof Halogen_HTML_Core.Element) {
                var tag = Halogen_HTML_Core.runTagName(v.value1);
                var ns$prime = Data_Function.apply(Data_Nullable.toNullable)(Data_Functor.map(Data_Maybe.functorMaybe)(Halogen_HTML_Core.runNamespace)(v.value0));
                var key = Data_Function.apply(Data_Nullable.toNullable)(Data_Foldable.foldl(Data_Foldable.foldableArray)(findKey)(Data_Maybe.Nothing.value)(v.value2));
                return Halogen_Internal_VirtualDOM.vnode(ns$prime)(tag)(key)(Data_Foldable.foldMap(Data_Foldable.foldableArray)(Halogen_Internal_VirtualDOM.monoidProps)(renderProp(f))(v.value2))(Data_Functor.map(Data_Functor.functorArray)(go)(v.value3));
            };
            throw new Error("Failed pattern match at Halogen.HTML.Renderer.VirtualDOM line 49, column 5 - line 56, column 28: " + [ v.constructor.name ]);
        };
        return go(Data_Lazy.force(tree.html));
    });
};
module.exports = {
    renderHTML: renderHTML, 
    renderTree: renderTree
};
