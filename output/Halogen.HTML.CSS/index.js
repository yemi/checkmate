// Generated by psc version 0.9.1
"use strict";
var Prelude = require("../Prelude");
var Data_Array = require("../Data.Array");
var Data_Either = require("../Data.Either");
var Data_List = require("../Data.List");
var Data_Maybe = require("../Data.Maybe");
var Data_String = require("../Data.String");
var Data_StrMap = require("../Data.StrMap");
var Data_Tuple = require("../Data.Tuple");
var CSS_Property = require("../CSS.Property");
var CSS_Render = require("../CSS.Render");
var CSS_Stylesheet = require("../CSS.Stylesheet");
var Halogen_HTML = require("../Halogen.HTML");
var Halogen_HTML_Core = require("../Halogen.HTML.Core");
var Halogen_HTML_Properties = require("../Halogen.HTML.Properties");
var Data_Function = require("../Data.Function");
var Data_Functor = require("../Data.Functor");
var Data_Semigroup = require("../Data.Semigroup");
var Halogen_HTML_Elements = require("../Halogen.HTML.Elements");
var Data_Unfoldable = require("../Data.Unfoldable");
var Control_Bind = require("../Control.Bind");
var Control_Semigroupoid = require("../Control.Semigroupoid");
var Data_Foldable = require("../Data.Foldable");
var Styles = function (x) {
    return x;
};
var stylesheet = function (css) {
    var content = Data_Function.apply(Data_Maybe.fromMaybe(""))(Data_Function.apply(CSS_Render.renderedSheet)(CSS_Render.render(css)));
    return Halogen_HTML_Elements.style([ Halogen_HTML_Properties.type_("text/css") ])([ Halogen_HTML.text(content) ]);
};
var stylesIsProp = new Halogen_HTML_Core.IsProp(function (v) {
    return function (v1) {
        return function (v2) {
            return Data_Function.apply(Data_String.joinWith("; "))(Data_Functor.map(Data_Functor.functorArray)(function (v3) {
                return v3.value0 + (": " + v3.value1);
            })(Data_List.toUnfoldable(Data_Unfoldable.unfoldableArray)(Data_StrMap.toList(v2))));
        };
    };
});
var style = (function () {
    var rights = Data_Array.mapMaybe(Data_Either.either(Data_Function["const"](Data_Maybe.Nothing.value))(Data_Maybe.Just.create));
    var property = function (v) {
        if (v instanceof CSS_Stylesheet.Property) {
            return new Data_Maybe.Just(new Data_Tuple.Tuple(v.value0, v.value1));
        };
        return Data_Maybe.Nothing.value;
    };
    var rules = function (rs) {
        var properties = Control_Bind.bind(Control_Bind.bindArray)(Data_Array.mapMaybe(property)(rs))(function ($16) {
            return rights(CSS_Render.collect($16));
        });
        return Data_StrMap.fromList(Data_List.fromFoldable(Data_Foldable.foldableArray)(properties));
    };
    return function ($17) {
        return Halogen_HTML_Core.prop(stylesIsProp)(Halogen_HTML_Core.propName("style"))(Data_Function.apply(Data_Maybe.Just.create)(Halogen_HTML_Core.attrName("style")))(Styles(rules(CSS_Stylesheet.runS($17))));
    };
})();
var runStyles = function (v) {
    return v;
};
module.exports = {
    style: style, 
    stylesheet: stylesheet
};
